VERSION 5.00
Begin VB.Form frmMine 
   BorderStyle     =   1  'Fixed Single
   Caption         =   "Mine All Mine"
   ClientHeight    =   3615
   ClientLeft      =   2670
   ClientTop       =   1815
   ClientWidth     =   3600
   LinkTopic       =   "Form1"
   LockControls    =   -1  'True
   MaxButton       =   0   'False
   MinButton       =   0   'False
   ScaleHeight     =   3615
   ScaleWidth      =   3600
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   0
      Left            =   4080
      TabIndex        =   100
      TabStop         =   0   'False
      Top             =   240
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   100
      Left            =   3240
      TabIndex        =   99
      TabStop         =   0   'False
      Top             =   3240
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   99
      Left            =   2880
      TabIndex        =   98
      TabStop         =   0   'False
      Top             =   3240
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   98
      Left            =   2520
      TabIndex        =   97
      TabStop         =   0   'False
      Top             =   3240
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   97
      Left            =   2160
      TabIndex        =   96
      TabStop         =   0   'False
      Top             =   3240
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   96
      Left            =   1800
      TabIndex        =   95
      TabStop         =   0   'False
      Top             =   3240
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   95
      Left            =   1440
      TabIndex        =   94
      TabStop         =   0   'False
      Top             =   3240
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   94
      Left            =   1080
      TabIndex        =   93
      TabStop         =   0   'False
      Top             =   3240
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   93
      Left            =   720
      TabIndex        =   92
      TabStop         =   0   'False
      Top             =   3240
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   92
      Left            =   360
      TabIndex        =   91
      TabStop         =   0   'False
      Top             =   3240
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   91
      Left            =   0
      TabIndex        =   90
      TabStop         =   0   'False
      Top             =   3240
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   90
      Left            =   3240
      TabIndex        =   89
      TabStop         =   0   'False
      Top             =   2880
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   89
      Left            =   2880
      TabIndex        =   88
      TabStop         =   0   'False
      Top             =   2880
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   88
      Left            =   2520
      TabIndex        =   87
      TabStop         =   0   'False
      Top             =   2880
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   87
      Left            =   2160
      TabIndex        =   86
      TabStop         =   0   'False
      Top             =   2880
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   86
      Left            =   1800
      TabIndex        =   85
      TabStop         =   0   'False
      Top             =   2880
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   85
      Left            =   1440
      TabIndex        =   84
      TabStop         =   0   'False
      Top             =   2880
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   84
      Left            =   1080
      TabIndex        =   83
      TabStop         =   0   'False
      Top             =   2880
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   83
      Left            =   720
      TabIndex        =   82
      TabStop         =   0   'False
      Top             =   2880
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   82
      Left            =   360
      TabIndex        =   81
      TabStop         =   0   'False
      Top             =   2880
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   81
      Left            =   0
      TabIndex        =   80
      TabStop         =   0   'False
      Top             =   2880
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   80
      Left            =   3240
      TabIndex        =   79
      TabStop         =   0   'False
      Top             =   2520
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   79
      Left            =   2880
      TabIndex        =   78
      TabStop         =   0   'False
      Top             =   2520
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   78
      Left            =   2520
      TabIndex        =   77
      TabStop         =   0   'False
      Top             =   2520
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   77
      Left            =   2160
      TabIndex        =   76
      TabStop         =   0   'False
      Top             =   2520
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   76
      Left            =   1800
      TabIndex        =   75
      TabStop         =   0   'False
      Top             =   2520
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   75
      Left            =   1440
      TabIndex        =   74
      TabStop         =   0   'False
      Top             =   2520
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   74
      Left            =   1080
      TabIndex        =   73
      TabStop         =   0   'False
      Top             =   2520
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   73
      Left            =   720
      TabIndex        =   72
      TabStop         =   0   'False
      Top             =   2520
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   72
      Left            =   360
      TabIndex        =   71
      TabStop         =   0   'False
      Top             =   2520
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   71
      Left            =   0
      TabIndex        =   70
      TabStop         =   0   'False
      Top             =   2520
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   70
      Left            =   3240
      TabIndex        =   69
      TabStop         =   0   'False
      Top             =   2160
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   69
      Left            =   2880
      TabIndex        =   68
      TabStop         =   0   'False
      Top             =   2160
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   68
      Left            =   2520
      TabIndex        =   67
      TabStop         =   0   'False
      Top             =   2160
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   67
      Left            =   2160
      TabIndex        =   66
      TabStop         =   0   'False
      Top             =   2160
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   66
      Left            =   1800
      TabIndex        =   65
      TabStop         =   0   'False
      Top             =   2160
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   65
      Left            =   1440
      TabIndex        =   64
      TabStop         =   0   'False
      Top             =   2160
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   64
      Left            =   1080
      TabIndex        =   63
      TabStop         =   0   'False
      Top             =   2160
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   63
      Left            =   720
      TabIndex        =   62
      TabStop         =   0   'False
      Top             =   2160
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   62
      Left            =   360
      TabIndex        =   61
      TabStop         =   0   'False
      Top             =   2160
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   61
      Left            =   0
      TabIndex        =   60
      TabStop         =   0   'False
      Top             =   2160
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   60
      Left            =   3240
      TabIndex        =   59
      TabStop         =   0   'False
      Top             =   1800
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   59
      Left            =   2880
      TabIndex        =   58
      TabStop         =   0   'False
      Top             =   1800
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   58
      Left            =   2520
      TabIndex        =   57
      TabStop         =   0   'False
      Top             =   1800
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   57
      Left            =   2160
      TabIndex        =   56
      TabStop         =   0   'False
      Top             =   1800
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   56
      Left            =   1800
      TabIndex        =   55
      TabStop         =   0   'False
      Top             =   1800
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   55
      Left            =   1440
      TabIndex        =   54
      TabStop         =   0   'False
      Top             =   1800
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   54
      Left            =   1080
      TabIndex        =   53
      TabStop         =   0   'False
      Top             =   1800
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   53
      Left            =   720
      TabIndex        =   52
      TabStop         =   0   'False
      Top             =   1800
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   52
      Left            =   360
      TabIndex        =   51
      TabStop         =   0   'False
      Top             =   1800
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   51
      Left            =   0
      TabIndex        =   50
      TabStop         =   0   'False
      Top             =   1800
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   50
      Left            =   3240
      TabIndex        =   49
      TabStop         =   0   'False
      Top             =   1440
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   49
      Left            =   2880
      TabIndex        =   48
      TabStop         =   0   'False
      Top             =   1440
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   48
      Left            =   2520
      TabIndex        =   47
      TabStop         =   0   'False
      Top             =   1440
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   47
      Left            =   2160
      TabIndex        =   46
      TabStop         =   0   'False
      Top             =   1440
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   46
      Left            =   1800
      TabIndex        =   45
      TabStop         =   0   'False
      Top             =   1440
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   45
      Left            =   1440
      TabIndex        =   44
      TabStop         =   0   'False
      Top             =   1440
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   44
      Left            =   1080
      TabIndex        =   43
      TabStop         =   0   'False
      Top             =   1440
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   43
      Left            =   720
      TabIndex        =   42
      TabStop         =   0   'False
      Top             =   1440
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   42
      Left            =   360
      TabIndex        =   41
      TabStop         =   0   'False
      Top             =   1440
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   41
      Left            =   0
      TabIndex        =   40
      TabStop         =   0   'False
      Top             =   1440
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   40
      Left            =   3240
      TabIndex        =   39
      TabStop         =   0   'False
      Top             =   1080
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   39
      Left            =   2880
      TabIndex        =   38
      TabStop         =   0   'False
      Top             =   1080
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   38
      Left            =   2520
      TabIndex        =   37
      TabStop         =   0   'False
      Top             =   1080
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   37
      Left            =   2160
      TabIndex        =   36
      TabStop         =   0   'False
      Top             =   1080
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   36
      Left            =   1800
      TabIndex        =   35
      TabStop         =   0   'False
      Top             =   1080
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   35
      Left            =   1440
      TabIndex        =   34
      TabStop         =   0   'False
      Top             =   1080
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   34
      Left            =   1080
      TabIndex        =   33
      TabStop         =   0   'False
      Top             =   1080
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   33
      Left            =   720
      TabIndex        =   32
      TabStop         =   0   'False
      Top             =   1080
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   32
      Left            =   360
      TabIndex        =   31
      TabStop         =   0   'False
      Top             =   1080
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   31
      Left            =   0
      TabIndex        =   30
      TabStop         =   0   'False
      Top             =   1080
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   30
      Left            =   3240
      TabIndex        =   29
      TabStop         =   0   'False
      Top             =   720
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   29
      Left            =   2880
      TabIndex        =   28
      TabStop         =   0   'False
      Top             =   720
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   28
      Left            =   2520
      TabIndex        =   27
      TabStop         =   0   'False
      Top             =   720
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   27
      Left            =   2160
      TabIndex        =   26
      TabStop         =   0   'False
      Top             =   720
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   26
      Left            =   1800
      TabIndex        =   25
      TabStop         =   0   'False
      Top             =   720
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   25
      Left            =   1440
      TabIndex        =   24
      TabStop         =   0   'False
      Top             =   720
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   24
      Left            =   1080
      TabIndex        =   23
      TabStop         =   0   'False
      Top             =   720
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   23
      Left            =   720
      TabIndex        =   22
      TabStop         =   0   'False
      Top             =   720
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   22
      Left            =   360
      TabIndex        =   21
      TabStop         =   0   'False
      Top             =   720
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   21
      Left            =   0
      TabIndex        =   20
      TabStop         =   0   'False
      Top             =   720
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   20
      Left            =   3240
      TabIndex        =   19
      TabStop         =   0   'False
      Top             =   360
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   19
      Left            =   2880
      TabIndex        =   18
      TabStop         =   0   'False
      Top             =   360
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   18
      Left            =   2520
      TabIndex        =   17
      TabStop         =   0   'False
      Top             =   360
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   17
      Left            =   2160
      TabIndex        =   16
      TabStop         =   0   'False
      Top             =   360
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   16
      Left            =   1800
      TabIndex        =   15
      TabStop         =   0   'False
      Top             =   360
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   15
      Left            =   1440
      TabIndex        =   14
      TabStop         =   0   'False
      Top             =   360
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   14
      Left            =   1080
      TabIndex        =   13
      TabStop         =   0   'False
      Top             =   360
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   13
      Left            =   720
      TabIndex        =   12
      TabStop         =   0   'False
      Top             =   360
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   12
      Left            =   360
      TabIndex        =   11
      TabStop         =   0   'False
      Top             =   360
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   11
      Left            =   0
      TabIndex        =   10
      TabStop         =   0   'False
      Top             =   360
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   10
      Left            =   3240
      TabIndex        =   9
      TabStop         =   0   'False
      Top             =   0
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   9
      Left            =   2880
      TabIndex        =   8
      TabStop         =   0   'False
      Top             =   0
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   8
      Left            =   2520
      TabIndex        =   7
      TabStop         =   0   'False
      Top             =   0
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   7
      Left            =   2160
      TabIndex        =   6
      TabStop         =   0   'False
      Top             =   0
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   6
      Left            =   1800
      TabIndex        =   5
      TabStop         =   0   'False
      Top             =   0
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   5
      Left            =   1440
      TabIndex        =   4
      TabStop         =   0   'False
      Top             =   0
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   4
      Left            =   1080
      TabIndex        =   3
      TabStop         =   0   'False
      Top             =   0
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   3
      Left            =   720
      TabIndex        =   2
      TabStop         =   0   'False
      Top             =   0
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   2
      Left            =   360
      TabIndex        =   1
      TabStop         =   0   'False
      Top             =   0
      Width           =   375
   End
   Begin VB.CommandButton m 
      Height          =   375
      Index           =   1
      Left            =   0
      TabIndex        =   0
      TabStop         =   0   'False
      Top             =   0
      Width           =   375
   End
   Begin VB.Menu mnugame 
      Caption         =   "Game"
      Begin VB.Menu mnunew 
         Caption         =   "New Game"
      End
      Begin VB.Menu sepgame1 
         Caption         =   "-"
      End
      Begin VB.Menu mnuexit 
         Caption         =   "Exit"
      End
   End
End
Attribute VB_Name = "frmMine"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Private Sub Form_Load()
Randomize 'start the random timer.  This way when you use the random function in the New Game menu option it will choose random numbers.

End Sub

Private Sub m_Click(Index As Integer)


'*****NOTES*****'
'a timer randomly adds the letter 'b' to a random number of buttons.
'when these are found then 1 is added to the bombs variable
'the bomb variable is declared in the modmine module

'***************'
currentindex = Index 'see which button was just pressed and store it for calculations

bombs = 0 'make sure that the bomb variable is empty

If frmMine.m(currentindex).Tag = "b" Then
    Call bombfound 'call the bombfound sub if this button has a bomb on it.
    Exit Sub 'don't run the code after this if..then function
End If 'end of the if function

Call babove 'run the sub which checks the button above this one
Call bbelow 'run the sub which checks the button below this one
Call bright 'run the sub which checks the button to the right of this one
Call bleft 'run the sub which checks the button to the left of this one
Call baboveleft 'run the sub which checks the button above and to the left of this one
Call baboveright 'run the sub which checks the button above and to the right of this one
Call bbelowleft 'run the sub which checks the button below and to the left of this one
Call bbelowright 'run the sub which checks the button below and to the right of this one

If bombs = 0 Then 'if there are no bombs make the current button disappear
    m(Index).Visible = False
Else
    m(Index).Caption = bombs 'else make the buttons caption show the number of bombs
End If ' end the if function

Call check4win 'call the sub which checks to make sure that the user hasn't won yet

m(0).SetFocus 'move the mouse focus to the hidden control, this way the user won't see the upper left hand button get the focus.


End Sub

Private Sub mnuexit_Click()
Unload Me 'unload the frmmine form
End 'end the program

End Sub

Private Sub mnunew_Click()
Dim nextindex As Integer 'declare the variable which will hold which index of the array we are on

For nextindex = 1 To 100 Step 1 ' Use the for..next statement to move through the index numbers starting with 1 and ending at 100 using 1 number increments
    m(nextindex).Caption = "" 'clear the caption of all of the buttons
    m(nextindex).Visible = True 'make all of the buttons visible
    m(nextindex).Tag = "" 'clear the tag of each button,  Thus making sure that there are no "Bombs" hidden for the next game
    m(nextindex).Enabled = True 'make sure that the button is enabled
Next ' end the for..next statement

nextindex = 0 'make sure the nextindex variable is empty

Dim bombnumber As Integer 'declare the variable for how many bombs are going to be in this game.
Dim bombindex As Integer 'declare the variable for the index of the button that will have a bomb in it during the following for..next loop

bombnumber = Int((10 * Rnd) + 1) 'the number of bombs are going to be chosen randomly out of a possible 10

For nextindex = 1 To bombnumber Step 1 'start the for next loop which will randomly pick a button to be a bomb.  It will only run as many times as was chosen randomly by the bombnumber variable
Retry: 'this will be the return point if a button already has a bomb in it
    bombindex = Int((100 * Rnd) + 1) 'generate a random number between 1 and 100
    If m(bombindex).Tag = "b" Then 'check to see if the current button that is generated by the random function has a bomb in it
        GoTo Retry 'if it does then have it return to the retry that way a new random number will be chose and a new button will be checked
    Else
        m(bombindex).Tag = "b" 'if it doesn't then have it mark the current button as a bomb
    End If 'end the if function
Next 'end the for..next loop

End Sub
